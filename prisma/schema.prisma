// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum jenis_kelamin {
  laki
  perempuan
}
model admin {
  id Int @id
  username String @db.VarChar(255)
  password String @db.VarChar(255)
}
enum status_pkl {
  pkl
  belum_pkl
}
// siswa get dudi, get dudi by name by alamat,get data diri sendiri, pengajuan Pkl,get data pengjuan pkl
model siswa {
  id Int @id
  nis Int @unique
  nama String @db.VarChar(255)
  kelas String @db.VarChar(255)
  jurusan String @db.VarChar(255)
  jenis_kelamin jenis_kelamin
  no_telepon String @db.VarChar(12) @unique
  id_guru_pembimbing Int
  id_dudi Int?
  id_pembimbing_dudi Int?
  tanggal_masuk DateTime?
  tanggal_keluar DateTime?
  password String @db.VarChar(255)
  status status_pkl

  alamat alamat_siswa?
  pengajuan_pkl pangajuan_pkl[]
  absen absen[]
  laporan_pkl laporan_pkl[]
  laporans_siswa_pkl laporan_siswa_pkl[]
  guru_pembimbing guru_pembimbing @relation(fields: [id_guru_pembimbing],references: [id])
  dudi dudi? @relation(fields: [id_dudi],references: [id])
  pembimbing_dudi Pembimbing_dudi? @relation(fields: [id_pembimbing_dudi],references: [id])
}
model alamat_siswa {
  id_siswa Int @id
  detail_tempat String @db.VarChar(255)
  desa String @db.VarChar(255)
  kecamatan String @db.VarChar(255)
  kabupaten String @db.VarChar(255)
  provinsi String @db.VarChar(255)
  negara String @db.VarChar(255)

  siswa siswa @relation(fields: [id_siswa],references: [id],onDelete: Cascade)
} 
model guru_pembimbing {
  id Int @id
  nip Int @unique
  nama String @db.VarChar(255)
  no_telepon String @db.VarChar(12) @unique
  jenis_kelamin jenis_kelamin
  tempat_lahir String @db.VarChar(255)
  tanggal_lahir String
  agama String @db.VarChar(255)
  password String @db.VarChar(255)

  siswa siswa[]
  alamat alamat_guru_Pembimbing?
  kunjungan_guru_pembimbing kunjungan_guru_pembimbing_pkl[]

}
model alamat_guru_Pembimbing {
  id_guru_Pembimbing Int @id
  detail_tempat String @db.VarChar(255)
  desa String @db.VarChar(255)
  kecamatan String @db.VarChar(255)
  kabupaten String @db.VarChar(255)
  provinsi String @db.VarChar(255)
  negara String @db.VarChar(255)

  guru_pembimbing guru_pembimbing @relation(fields: [id_guru_Pembimbing],references: [id],onDelete: Cascade)
}
model Pembimbing_dudi {
  id Int @id
  id_dudi Int
  nama String @db.VarChar(255)
  username String @db.VarChar(255)
  no_telepon String @db.VarChar(12) @unique
  password String @db.VarChar(255)
  jenis_kelamin jenis_kelamin
  agama String @db.VarChar(255)

  siswa siswa[]
  alamat alamat_pembimbing_dudi?
  absen absen[]
  laporan_pkl laporan_pkl[]
  laporans_siswa_pkl laporan_siswa_pkl[]
  kunjungan_guru_pembimbing kunjungan_guru_pembimbing_pkl[]

  dudi dudi @relation(fields: [id_dudi],references: [id])
}
model dudi {
  id Int @id
  nama_instansi_perusahaan String @db.VarChar(255) @unique
  no_telepon String @db.VarChar(12) 
  bidang String @db.VarChar(255)
  catatan String @db.VarChar(1500)

  alamat alamat_dudi?
  siswa siswa[]
  pengajuan_pkl pangajuan_pkl[]
  absen absen[]
  laporan_pkl laporan_pkl[]
  laporans_siswa_pkl laporan_siswa_pkl[]
  kunjungan_guru_pembimbing kunjungan_guru_pembimbing_pkl[]
  pembimbing_dudi Pembimbing_dudi[]
}
model alamat_pembimbing_dudi {
  id_pembimbing_dudi Int @id
  detail_tempat String @db.VarChar(255)
  desa String @db.VarChar(255)
  kecamatan String @db.VarChar(255)
  kabupaten String @db.VarChar(255)
  provinsi String @db.VarChar(255)
  negara String @db.VarChar(255)

  pembimbing_dudi Pembimbing_dudi @relation(fields: [id_pembimbing_dudi],references: [id],onDelete: Cascade)
}
model alamat_dudi {
  id_dudi Int @id
  detail_tempat String @db.VarChar(255)
  desa String @db.VarChar(255)
  kecamatan String @db.VarChar(255)
  kabupaten String @db.VarChar(255)
  provinsi String @db.VarChar(255)
  negara String @db.VarChar(255)

  dudi dudi @relation(fields: [id_dudi],references: [id],onDelete: Cascade)
}
enum status_pengajuan {
  proses 
  diterima
  ditolak
}
model pangajuan_pkl {
  id Int @id
  id_siswa Int
  id_dudi Int
  status status_pengajuan 
  waktu_pengajuan DateTime @default(now())

  siswa siswa @relation(fields: [id_siswa],references: [id])
  dudi dudi @relation(fields: [id_dudi],references: [id])
}
model absen {
  id Int @id
  id_siswa Int
  id_dudi Int
  id_pembimbing_dudi Int
  tanggal DateTime
  absen_masuk DateTime
  absen_pulang DateTime
  status status_absen
  keterangan String @db.VarChar(1500)

  siswa siswa @relation(fields: [id_siswa],references: [id])
  dudi dudi @relation(fields: [id_dudi],references: [id])
  pembimbing_dudi Pembimbing_dudi @relation(fields: [id_pembimbing_dudi],references: [id])
}
model laporan_pkl {
  id Int @id
  id_siswa Int
  id_dudi Int
  id_pembimbing_dudi Int
  tanggal DateTime
  keterangan String @db.VarChar(1500)
  file_laporan String @db.VarChar(1500)

  siswa siswa @relation(fields: [id_siswa],references: [id])
  dudi dudi @relation(fields: [id_dudi],references: [id])
  pembimbing_dudi Pembimbing_dudi @relation(fields: [id_pembimbing_dudi],references: [id])
}
model laporan_siswa_pkl {
  id Int @id
  id_siswa Int
  id_dudi Int
  id_pembimbing_dudi Int
  tanggal DateTime
  topik_pekerjaan String @db.VarChar(255)
  rujukan_kompetensi_dasar String @db.VarChar(255)
  dokumentasi String @db.VarChar(1500)

  siswa siswa @relation(fields: [id_siswa],references: [id])
  dudi dudi @relation(fields: [id_dudi],references: [id])
  pembimbing_dudi Pembimbing_dudi @relation(fields: [id_pembimbing_dudi],references: [id])
}
model kunjungan_guru_pembimbing_pkl {
  id Int @id
  id_guru_pembimbing Int
  id_dudi Int
  id_pembimbing_dudi Int
  tanggal_kunjungan DateTime
  catatan String @db.VarChar(1500)

 dudi dudi @relation(fields: [id_dudi],references: [id])
 guru_pembimbing guru_pembimbing @relation(fields: [id_guru_pembimbing],references: [id])
 pembimbing_dudi Pembimbing_dudi @relation(fields: [id_pembimbing_dudi],references: [id])
}

enum status_absen {
  datang
  pulang
}